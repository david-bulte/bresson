/**
 * bresson
 * @version v0.0.1 - 2015-10-28
 * @link https://github.com/david-bulte/bresson
 * @author  <>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";function Config(a){a.put("templates/dateselector.html",'<any ng-switch="ctrl.viaDateInput"><input type="date" ng-model="ctrl.modelDate" ng-switch-when="true" class="{{ctrl.brAttributes.class}}" placeholder="{{ctrl.brAttributes.placeholder}}"><any ng-switch-default ng-switch="ctrl._dayBeforeMonth"><any ng-switch-when="true"><select class="{{ctrl.brAttributes.class}}" ng-model="ctrl.viewDate.day.id" ng-options="day.label as day.id for day in ctrl.days" ng-change="ctrl.dayChanged()"></select> <select class="{{ctrl.brAttributes.class}}" ng-model="ctrl.viewDate.month.id" ng-options="month.label as month.id for month in ctrl.months" ng-change="ctrl.monthOrYearChanged()"></select> <select class="{{ctrl.brAttributes.class}}" ng-model="ctrl.viewDate.year.id" ng-options="year.label as year.id for year in ctrl.years" ng-change="ctrl.monthOrYearChanged()"></select></any><any ng-switch-default><select class="{{ctrl.brAttributes.class}}" ng-model="ctrl.viewDate.month.id" ng-options="month.label as month.id for month in ctrl.months" ng-change="ctrl.monthOrYearChanged()"></select> <select class="{{ctrl.brAttributes.class}}" ng-model="ctrl.viewDate.day.id" ng-options="day.label as day.id for day in ctrl.days" ng-change="ctrl.dayChanged()"></select> <select class="{{ctrl.brAttributes.class}}" ng-model="ctrl.viewDate.year.id" ng-options="year.label as year.id for year in ctrl.years" ng-change="ctrl.monthOrYearChanged()"></select></any></any></any>')}function DateSelectorDirective(){return{restrict:"E",templateUrl:"templates/dateselector.html",scope:{modelDate:"=date",fromYear:"=",toYear:"=",dayBeforeMonth:"=",tryDateInput:"=",brAttributes:"="},controller:DateSelectorController,controllerAs:"ctrl",bindToController:!0}}function DateSelectorController(a){var b=this;this.viaDateInput=(void 0===this.tryDateInput||this.tryDateInput===!0)&&dateInputSupported();var c=this.fromYear,d=this.toYear;if(!this.viaDateInput){if(!c!=!d)throw"bresson: when specifying fromYear you should als specify toYear";if(c&&this.modelDate&&(this.modelDate.getFullYear()<c||this.modelDate.getFullYear()>d))throw"bresson: given date does not fall between given fromYear and toYear";this.modelDate||(this.modelDate=new Date),c||(c=this.modelDate.getFullYear()-50,d=this.modelDate.getFullYear()+50),this.viewDate={day:{id:this.modelDate.getDate(),label:this.modelDate.getDate()},month:{id:this.modelDate.getMonth()+1,label:this.modelDate.getMonth()+1},year:{id:this.modelDate.getFullYear(),label:this.modelDate.getFullYear()}},this.viewDate.toDate=function(){return this.day&&this.month&&this.year?new Date(this.year.id,this.month.id-1,this.day.id):null}.bind(this.viewDate),this.days=options(1,daysInMonth(this.modelDate.getMonth()+1,this.modelDate.getFullYear())),this.months=options(1,12),this.years=options(c,d),a.$watch("ctrl.dayBeforeMonth",function(a){if(b._dayBeforeMonth=b.dayBeforeMonth,void 0===b._dayBeforeMonth){var c=new Date(Date.UTC(1972,5,9,0,0));b._dayBeforeMonth="09/05/1972"===c.toLocaleDateString()}}),this.dayChanged=function(){this.modelDate=this.viewDate.toDate()},this.monthOrYearChanged=function(){var a=daysInMonth(this.viewDate.month.id,this.viewDate.year.id);this.viewDate.day&&this.viewDate.day.id>a&&(this.viewDate.day=null),this.modelDate=this.viewDate.toDate(),this.days=options(1,a)}}}function options(a,b){for(var c=[],d=a;b>=d;d++)c.push({id:d,label:d});return c}function daysInMonth(a,b){return new Date(b,a,0).getDate()}function dateInputSupported(){var a=document.createElement("input");a.setAttribute("type","date");var b="not-a-date";return a.setAttribute("value",b),!(a.value===b)}angular.module("bresson",[]).run(Config).directive("brDateSelector",DateSelectorDirective),Config.$inject=["$templateCache"],DateSelectorController.$inject=["$scope"];